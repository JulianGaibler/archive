# ===========================================
# ANSIBLE ENVIRONMENT TEMPLATE
# ===========================================
# Jinja2 template for generating environment files via Ansible
# Variables should be defined in your Ansible inventory or playbook

# Environment Configuration
NODE_ENV={{ node_env | default('production') }}

# ===========================================
# BACKEND CONFIGURATION
# ===========================================

BACKEND_PORT={{ backend_port | default(4000) }}
BACKEND_GRAPHQL_PATH={{ backend_graphql_path | default('/graphql') }}
BACKEND_WEBSOCKET_PATH={{ backend_websocket_path | default('/ws') }}

{% if node_env == 'development' %}
BACKEND_FILE_SERVE_PATH={{ backend_file_serve_path | default('/content') }}
CORS_ORIGIN={{ cors_origin | default('http://localhost:4321') }}
BACKEND_FILE_STORAGE_DIR={{ backend_file_storage_dir | default('./public') }}
{% else %}
CORS_ORIGIN={{ cors_origin | default('http://localhost:8080') }}
BACKEND_FILE_STORAGE_DIR={{ backend_file_storage_dir | default('/app/files') }}
{% endif %}

# ===========================================
# BACKEND UPLOAD SETTINGS
# ===========================================

BACKEND_UPLOAD_MAX_FILE_SIZE={{ backend_upload_max_file_size | default(52428800) }}
BACKEND_UPLOAD_MAX_FILES={{ backend_upload_max_files | default(10) }}
BACKEND_TELEGRAM_BOT_TOKEN={{ backend_telegram_bot_token | default('') }}

{% if node_env == 'development' %}
BACKEND_SESSION_SECRETS={{ backend_session_secrets | default('1=dev-session-secret-change-in-production') }}
{% else %}
BACKEND_SESSION_SECRETS={{ backend_session_secrets }}
{% endif %}

# ===========================================
# BACKEND DEBUG SETTINGS
# ===========================================

{% if node_env == 'development' %}
{% if backend_create_accounts is defined %}
BACKEND_CREATE_ACCOUNTS={{ backend_create_accounts }}
{% endif %}
{% if debug_enabled is defined and debug_enabled %}
DEBUG={{ debug_flags | default('knex:query,knex:bindings') }}
{% endif %}
{% endif %}

# ===========================================
# FRONTEND CONFIGURATION
# ===========================================

{% if node_env == 'development' %}
FRONTEND_PORT={{ frontend_port | default(4321) }}
FRONTEND_FILES_BASE_URL={{ frontend_files_base_url | default('http://localhost:4000/content') }}
{% else %}
FRONTEND_PORT={{ frontend_port | default(8080) }}
FRONTEND_FILES_BASE_URL={{ frontend_files_base_url | default('/files') }}
{% endif %}

# ===========================================
# FRONTEND CLIENT-SIDE VARIABLES (PUBLIC_*)
# ===========================================

{% if node_env == 'development' %}
FRONTEND_PUBLIC_API_BASE_URL={{ frontend_public_api_base_url | default('http://localhost:4000') }}
FRONTEND_PUBLIC_GRAPHQL_ENDPOINT={{ frontend_public_graphql_endpoint | default('/graphql') }}
FRONTEND_PUBLIC_WS_ENDPOINT={{ frontend_public_ws_endpoint | default('/graphql/ws') }}
{% else %}
FRONTEND_PUBLIC_API_BASE_URL={{ frontend_public_api_base_url | default('') }}
FRONTEND_PUBLIC_GRAPHQL_ENDPOINT={{ frontend_public_graphql_endpoint | default('/api/graphql') }}
FRONTEND_PUBLIC_WS_ENDPOINT={{ frontend_public_ws_endpoint | default('/api/graphql/ws') }}
{% endif %}

# ===========================================
# FRONTEND SSR VARIABLES (PRIVATE_*)
# ===========================================

{% if node_env == 'development' %}
FRONTEND_PRIVATE_API_BASE_URL={{ frontend_private_api_base_url | default('http://localhost:4000') }}
FRONTEND_PRIVATE_GRAPHQL_ENDPOINT={{ frontend_private_graphql_endpoint | default('/graphql') }}
{% else %}
FRONTEND_PRIVATE_API_BASE_URL={{ frontend_private_api_base_url | default('http://server:4000') }}
FRONTEND_PRIVATE_GRAPHQL_ENDPOINT={{ frontend_private_graphql_endpoint | default('/api/graphql') }}
{% endif %}

# ===========================================
# DATABASE CONFIGURATION
# ===========================================

POSTGRES_USER={{ postgres_user | default('archive') }}
POSTGRES_PASSWORD={{ postgres_password }}
POSTGRES_DB={{ postgres_db }}

{% if node_env == 'development' %}
BACKEND_POSTGRES_HOST={{ backend_postgres_host | default('localhost') }}
{% else %}
BACKEND_POSTGRES_HOST={{ backend_postgres_host | default('database') }}
{% endif %}
BACKEND_POSTGRES_PORT={{ backend_postgres_port | default(5432) }}

# ===========================================
# DOCKER SERVICE NAMES
# ===========================================

DOCKER_FRONTEND_HOST={{ docker_frontend_host | default('client') }}
DOCKER_BACKEND_HOST={{ docker_backend_host | default('server') }}